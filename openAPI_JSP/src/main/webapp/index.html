
<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>openAPI_JSP</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href='./resources/css/App.css' />
	<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.slim.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
	<script>
		function check() {
			$.ajax({
		        type: "GET",
		        url: "http://openapi.seoul.go.kr:8088/6d4d776b466c656533356a4b4b5872/json/RealtimeCityAir/1/99",
		        data: {},
		        success: function(response){
		            $("#tableContent").empty();
		            let mise = response["RealtimeCityAir"]["row"]; 
		            for(let i = 0; i < mise.length; i++){ 
		                let gu_name = mise[i]["MSRSTE_NM"];
		                let gu_mise = mise[i]["IDEX_MVL"];
		                let gu_status = mise[i]["IDEX_NM"];
		                
		                let str_mise = "";
		                if(gu_mise > 99){ 
		                	str_mise = `<tr class="red"  style="color: red">
		                    <td>${gu_name}</td>
		                    <td>${gu_mise}</td>
		                    <td>${gu_status}</td></tr>`; 
		               	} else {
		            	   	str_mise = `<tr class="blue" style="color: blue">
		                    <td>${gu_name}</td>
		                    <td>${gu_mise}</td>
		                    <td>${gu_status}</td></tr>`; 
		               }
	                $("#tableContent").append(str_mise); 
		           }
	  			}
			})
	}
	</script>
</head>
<body>
	<div class="jumbotron text-right">
		<h1 class="h1txt">JQuery, Bootstrap 프로젝트</h1>
		<p class="ptxt">서울시 미세먼지(API) 측정 - <button type="button" class="btn btn-success" onclick="check()">시작!</button></p>
		<br>
		<button type="button" class="btn btn-light" onclick="location.href='./comment.jsp'">댓글남기기</button>
	</div>
	<div class="container">
		<table class="table">
			<thead>
				<tr>
					<th>서울시</th>
					<th>미세먼지</th>
					<th>상태</th>
				</tr>
			</thead>
			<tbody id="tableContent"></tbody>
		</table>
	</div>
</body>
</html>